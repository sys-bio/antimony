//Created by libAntimony v1.3
model overgaard_pharmacodynamic_2007__environment(time_)
end

model overgaard_pharmacodynamic_2007__model_parameters(T_a, T_b, delta_T, kinc, tdose1, tdose2, tdose3)

  // Variable initializations:
  T_a = 21.0;
  T_b = 38.0;
  delta_T = 1.57;
  kinc = 0.0258;
  tdose1 = 24.0;
  tdose2 = 72.0;
  tdose3 = 120.0;
end

model overgaard_pharmacodynamic_2007__M_c(M_c, M_day, M_night, time_)

  // Assignment Rules:
  M_c := piecewise( M_night , ( tprime / 3600 >= t_night) && (tprime / 3600 < t_day ), M_day );
  tprime := rem(time_ * 3600 * 1 , day_length);

  // Variable initializations:
  t_day = 17.5;
  t_night = 6.73;
  day_length = 86400;
end

model overgaard_pharmacodynamic_2007__M(M, M_c, time_)

  // Rate Rules:
  M' = -(km) * (M - M_c);

  // Variable initializations:
  M = 3.5;
  km = 1.1375;
end

model overgaard_pharmacodynamic_2007__T(T, k, M, T_a, time_)

  // Rate Rules:
  T' = power(c, -1 ) * (M - k * (T - T_a));

  // Variable initializations:
  T = 38.785;
  c = 3.47;
end

model overgaard_pharmacodynamic_2007__k(k, kinc, kb, T, T_b, f_prime, gNsTs1, gNsTs2, gNsTs3, gNfTf1, gNfTf2, gNfTf3, time_)

  // Assignment Rules:
  k := kb + kinc * (T - T_b * (1 + pEtot * BR)) + f2_drug;
  E_slow := AMT_dose * pEs2 * (gNsTs1 + gNsTs2 + gNsTs3);
  E_fast := pEf2 * (gNfTf1 + gNfTf2 + gNfTf3);
  f2_drug := 0;

  // Rate Rules:
  BR' = f_prime * (E_slow + E_fast) * (1 - BR) - kR * BR;

  // Variable initializations:
  BR = 0.0;
  pEtot = 0.144;
  kR = 5.35;
  AMT_dose = 3.0;
  pEf1 = 1.0;
  pEs1 = 0.2;
  pEf2 = 3.57;
  pEs2 = 2.43;
  pEf3 = 8.0;
  pEs3 = 50.0;
end

model overgaard_pharmacodynamic_2007__T_day(T_day, T_b, delta_T)

  // Assignment Rules:
  T_day := T_b + delta_T / 2;
end

model overgaard_pharmacodynamic_2007__T_night(T_night, T_b, delta_T)

  // Assignment Rules:
  T_night := T_b - delta_T / 2;
end

model overgaard_pharmacodynamic_2007__kb(kb, T_b, T_a)

  // Assignment Rules:
  kb := M_b / (T_b - T_a);

  // Variable initializations:
  M_b = 3.0;
end

model overgaard_pharmacodynamic_2007__M_day(M_day, kinc, kb, T_b, T_a, T_day)

  // Assignment Rules:
  M_day := (kb + kinc * (T_day - T_b)) * (T_day - T_a);
end

model overgaard_pharmacodynamic_2007__M_night(M_night, f_prime, tdose1, kinc, kb, T_b, T_a, T_night, M_day, time_)

  // Assignment Rules:
  M_night := (1 - f_prime) * M_night_baseline + f_prime * M_day;
  f_prime := delta_high_dose * power(1 + exp(-(alpha) * (time_ - (tdose1 + t_prime))), -1 );
  M_night_baseline := (kb + kinc * (T_night - T_b)) * (T_night - T_a);

  // Variable initializations:
  t_prime = 45.12;
  alpha = 0.2229166;
  delta_high_dose = 1.0;
end

model overgaard_pharmacodynamic_2007__gNT(gNsTs1, gNsTs2, gNsTs3, gNfTf1, gNfTf2, gNfTf3, tdose1, tdose2, tdose3, time_)

  // Assignment Rules:
  gNsTs1 := piecewise( power(Ks, Ns) / 6 * exp(-(Ks) * X1) * power(X1, Ns - 1 ) , X1 > 0 , 0 );
  gNsTs2 := piecewise( power(Ks, Ns) / 6 * exp(-(Ks) * X2) * power(X2, Ns - 1 ) , X2 > 0 , 0 );
  gNsTs3 := piecewise( power(Ks, Ns) / 6 * exp(-(Ks) * X3) * power(X3, Ns - 1 ) , X3 > 0 , 0 );
  gNfTf1 := piecewise( power(Kf, Nf) / 6 * exp(-(Kf) * X1) * power(X1, Nf - 1 ) , X1 > 0 , 0 );
  gNfTf2 := piecewise( power(Kf, Nf) / 6 * exp(-(Kf) * X2) * power(X2, Nf - 1 ) , X2 > 0 , 0 );
  gNfTf3 := piecewise( power(Kf, Nf) / 6 * exp(-(Kf) * X3) * power(X3, Nf - 1 ) , X3 > 0 , 0 );
  X1 := (time_ - tdose1) / 24;
  X2 := (time_ - tdose2) / 24;
  X3 := (time_ - tdose3) / 24;
  Kf := Nf / Tf;
  Ks := Ns / Ts;

  // Variable initializations:
  Ns = 4.0;
  Nf = 4.0;
  Ts = 2.45;
  Tf = 0.368;
end

model overgaard_pharmacodynamic_2007____main()

  // Sub-modules, and any changes to those submodules:
  environment: overgaard_pharmacodynamic_2007__environment(time_);
  model_parameters: overgaard_pharmacodynamic_2007__model_parameters(T_a, T_b, delta_T, kinc, tdose1, tdose2, tdose3);
  M_c: overgaard_pharmacodynamic_2007__M_c(M_c0, M_day0, M_night0, time_);
  M: overgaard_pharmacodynamic_2007__M(M0, M_c0, time_);
  T: overgaard_pharmacodynamic_2007__T(T0, k0, M0, T_a, time_);
  k: overgaard_pharmacodynamic_2007__k(k0, kinc, kb0, T0, T_b, f_prime, gNsTs1, gNsTs2, gNsTs3, gNfTf1, gNfTf2, gNfTf3, time_);
  T_day: overgaard_pharmacodynamic_2007__T_day(T_day0, T_b, delta_T);
  T_night: overgaard_pharmacodynamic_2007__T_night(T_night0, T_b, delta_T);
  kb: overgaard_pharmacodynamic_2007__kb(kb0, T_b, T_a);
  M_day: overgaard_pharmacodynamic_2007__M_day(M_day0, kinc, kb0, T_b, T_a, T_day0);
  M_night: overgaard_pharmacodynamic_2007__M_night(M_night0, f_prime, tdose1, kinc, kb0, T_b, T_a, T_night0, M_day0, time_);
  gNT: overgaard_pharmacodynamic_2007__gNT(gNsTs1, gNsTs2, gNsTs3, gNfTf1, gNfTf2, gNfTf3, tdose1, tdose2, tdose3, time_);
end
