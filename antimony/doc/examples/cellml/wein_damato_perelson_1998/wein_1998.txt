//Created by libAntimony v1.4
model wein_1998__environment(time_)
end

model wein_1998__uninfected_CD4(time_, T, T1_star, T2_star, k1, r1, V1_I, k2, r2, V2_I)

  // Rate Rules:
  T' = s + lambda_ * T * (1 - (T + T1_star + T2_star) / Tmax) - mu * T - k1 * (1 - r1) * T * V1_I - k2 * (1 - r2) * T * V2_I;

  // Variable initializations:
  T = 178.81;
  s = 0;
  lambda_ = 0.01;
  Tmax = 450;
  mu = 0.0014;
end

model wein_1998__uninfected_long_lived_cells(time_, M, k1_M, r1, V1_I, k2_M, r2, V2_I)

  // Rate Rules:
  M' = lambda_M - mu_M * M - k1_M * (1 - r1 ) * M * V1_I - k2_M * (1 - r2 ) * M * V2_I;

  // Variable initializations:
  M = 49.2;
  lambda_M = 2.0;
  mu_M = 0.04;
end

model wein_1998__productively_infected_CD4(time_, T1_star, m11, k1, r1, T, V1_I, m21, k2, r2, V2_I, delta1, T2_star, m22, m12, delta2)

  // Rate Rules:
  T1_star' = m11 * k1 * (1 - r1 ) * T * V1_I + m21 * k2 * (1 - r2 ) * T * V2_I - delta1 * T1_star;
  T2_star' = m22 * k2 * (1 - r2) * T * V2_I + m12 * k1 * (1 - r1) * T * V1_I - delta2 * T2_star;

  // Variable initializations:
  T1_star = 1.19;
  m11 = 1;
  k1 = 3.43E-8;
  m21 = 3.4E-5;
  k2 = 3.43E-8;
  delta1 = 0.69;
  T2_star = 0.004;
  m22 = 1;
  m12 = 3.4E-5;
  delta2 = 0.69;
end

model wein_1998__productively_infected_long_lived_cells(time_, M1_star, m11, k1_M, r1, M, V1_I, m21, k2_M, r2, V2_I, delta1_M, M2_star, m22, m12, delta2_M)

  // Rate Rules:
  M1_star' = m11 * k1_M * (1 - r1 ) * M * V1_I + m21 * k2_M * (1 - r2 ) * M * V2_I - delta1_M * M1_star;
  M2_star' = m22 * k2_M * (1 - r2 ) * M * V2_I + m12 * k1_M * (1 - r1 ) * M * V1_I - delta2_M * M2_star;

  // Variable initializations:
  M1_star = 0.49;
  k1_M = 4.67E-9;
  k2_M = 4.67E-9;
  delta1_M = 0.062;
  M2_star = 1.7E-3;
  delta2_M = 0.062;
end

model wein_1998__virus_strain1(time_, V1_I, p1, delta1, T1_star, delta1_M, M1_star)

  // Rate Rules:
  V1_I' = (1 - p1 ) * N1 * delta1 * T1_star + (1 - p1 ) * N1_M * delta1_M * M1_star - c1 * V1_I;
  V1' = N1 * delta1 * T1_star + N1_M * delta1_M * M1_star - c1 * V1;

  // Variable initializations:
  V1_I = 133500;
  N1 = 480.1;
  N1_M = 534.4;
  V1 = 133500;
  c1 = 3.07;
end

model wein_1998__virus_strain2(time_, V2_I, p2, delta2, T2_star, delta2_M, M2_star)

  // Rate Rules:
  V2_I' = (1 - p2 ) * N2 * delta2 * T2_star + (1 - p2 ) * N2_M * delta2_M * M2_star - c2 * V2_I;
  V2' = N2 * delta2 * T2_star + N2_M * delta2_M * M2_star - c2 * V2;

  // Variable initializations:
  V2_I = 450;
  N2 = 475.3;
  N2_M = 529.0;
  c2 = 3.07;
  V2 = 450;
end

model wein_1998__drug_parameters(r1, r2, p1, p2)

  // Variable initializations:
  r1 = 0.9;
  r2 = 0.25;
  p1 = 0.99;
  p2 = 0.25;
end

model wein_1998____main()

  // Sub-modules, and any changes to those submodules:
  environment: wein_1998__environment(time_);
  uninfected_CD4: wein_1998__uninfected_CD4(time_, T, T1_star, T2_star, k1, r1, V1_I, k2, r2, V2_I);
  uninfected_long_lived_cells: wein_1998__uninfected_long_lived_cells(time_, M, k1_M, r1, V1_I, k2_M, r2, V2_I);
  productively_infected_CD4: wein_1998__productively_infected_CD4(time_, T1_star, m11, k1, r1, T, V1_I, m21, k2, r2, V2_I, delta1, T2_star, m22, m12, delta2);
  productively_infected_long_lived_cells: wein_1998__productively_infected_long_lived_cells(time_, M1_star, m11, k1_M, r1, M, V1_I, m21, k2_M, r2, V2_I, delta1_M, M2_star, m22, m12, delta2_M);
  virus_strain1: wein_1998__virus_strain1(time_, V1_I, p1, delta1, T1_star, delta1_M, M1_star);
  virus_strain2: wein_1998__virus_strain2(time_, V2_I, p2, delta2, T2_star, delta2_M, M2_star);
  drug_parameters: wein_1998__drug_parameters(r1, r2, p1, p2);
end
