//Created by libAntimony v1.4
model bertram_satin_zhang_smolen_sherman_2004_version01__environment(time_)
end

model bertram_satin_zhang_smolen_sherman_2004_version01__membrane(V, ICa, IKATP, VK, c, time_)

  // Assignment Rules:
  IK := gK * n * (V - VK);
  ICa := gCa * minf * (V - VCa);
  IKCa := gKCa / (1 + power(kd / c, 2 )) * (V - VK);
  minf := 1 / (1 + exp(-((20 + V)) / 12 ));
  ninf := 1 / (1 + exp(-((16 + V)) / 5 ));

  // Rate Rules:
  V' = -((IK + ICa + IKCa + IKATP)) / Cm;
  n' = (ninf - n) / taun;

  // Variable initializations:
  V = -60;
  Cm = 5300;
  gK = 2700;
  n = 0;
  gKCa = 100;
  kd = 0.5;
  gCa = 1000;
  VCa = 25;
  taun = 20;
end

model bertram_satin_zhang_smolen_sherman_2004_version01__calcium_handling(time_, c, cer, ICa)

  // Assignment Rules:
  Jmem := -((alpha * ICa + kpmca * c));
  Jer := epser * (Jleak - Jserca) / lambdaer;
  Jserca := Kserca * c;
  Jleak := pleak * (cer - c);

  // Rate Rules:
  c' = fcyt * (Jmem + Jer);
  cer' = -(fer) * sigmaV * Jer;

  // Variable initializations:
  c = 0.1;
  cer = 185;
  fcyt = 0.01;
  fer = 0.01;
  sigmaV = 31;
  pleak = 0.0002;
  Kserca = 0.4;
  lambdaer = 1;
  epser = 1;
  alpha = 0.00000450;
  kpmca = 0.2;
end

model bertram_satin_zhang_smolen_sherman_2004_version01__glycolysis(time_, rgpdh, atot, pfkbas, f6p, pfk, fbp)

  // Assignment Rules:
  rgpdh := 0.2 * root(fbp / 1 );
  f6p := 0.3 * g6p;

  // Rate Rules:
  g6p' = lambda_ * (Rgk * 1 - pfk / 1 );
  fbp' = lambda_ * (pfk / 1 - 0.5 * rgpdh);

  // Variable initializations:
  Rgk = 0.2;
  atot = 3000;
  pfkbas = 0.06;
  lambda_ = 0.005;
  g6p = 200;
  fbp = 40;
end

model bertram_satin_zhang_smolen_sherman_2004_version01__pfk(time_, pfk, pfkbas, atp, f6p, fbp, amp)

  // Assignment Rules:
  pfk := 1 * ((pfkbas * cat * topa16 + cat * topb) / bottom16);
  weight2 := power(atp, 2 ) / (k4 * 1 );
  topa2 := topa1;
  bottom2 := bottom1 + weight2;
  topa3 := topa2 + weight3;
  weight3 := power(f6p, 2 ) / (k3 * 1 );
  bottom3 := bottom2 + weight3;
  weight4 := power(f6p * atp, 2 ) / (fatp * k3 * k4 * power(1 , 2 ));
  topa4 := topa3 + weight4;
  bottom4 := bottom3 + weight4;
  weight5 := fbp / k2;
  topa5 := topa4;
  bottom5 := bottom4 + weight5;
  weight6 := fbp * power(atp, 2 ) / (k2 * k4 * fbt * 1 );
  topa6 := topa5;
  bottom6 := bottom5 + weight6;
  weight7 := fbp * power(f6p, 2 ) / (k2 * k3 * ffbp * 1 );
  topa7 := topa6 + weight7;
  bottom7 := bottom6 + weight7;
  weight8 := fbp * power(f6p, 2 ) * power(atp, 2 ) / (k2 * k3 * k4 * ffbp * fbt * fatp * power(1 , 2 ));
  topa8 := topa7 + weight8;
  bottom8 := bottom7 + weight8;
  weight9 := amp / k1;
  topa9 := topa8;
  bottom9 := bottom8 + weight9;
  weight10 := amp * power(atp, 2 ) / (k1 * k4 * fmt * 1 );
  topa10 := topa9;
  bottom10 := bottom9 + weight10;
  weight11 := amp * power(f6p, 2 ) / (k1 * k3 * famp * 1 );
  topa11 := topa10 + weight11;
  bottom11 := bottom10 + weight11;
  weight12 := amp * power(f6p, 2 ) * power(atp, 2 ) / (k1 * k3 * k4 * famp * fmt * fatp * power(1 , 2 ));
  topa12 := topa11 + weight12;
  bottom12 := bottom11 + weight12;
  weight13 := amp * fbp / (k1 * k2);
  topa13 := topa12;
  bottom13 := bottom12 + weight13;
  weight14 := amp * fbp * power(atp, 2 ) / (k1 * k2 * k4 * fbt * fmt * 1 );
  topa14 := topa13;
  bottom14 := bottom13 + weight14;
  weight15 := amp * fbp * power(f6p, 2 ) / (k1 * k2 * k3 * ffbp * famp * 1 );
  topa15 := topa14;
  bottom15 := bottom14 + weight15;
  weight16 := amp * fbp * power(f6p, 2 ) * power(atp, 2 ) / (k1 * k2 * k3 * k4 * ffbp * famp * fbt * fmt * fatp * power(1 , 2 ));
  topa16 := topa15 + weight16;
  bottom16 := bottom15 + weight16;
  topb := weight15;

  // Variable initializations:
  bottom1 = 1;
  topa1 = 0;
  k1 = 30;
  k2 = 1;
  k3 = 50000;
  k4 = 1000;
  cat = 2;
  famp = 0.02;
  fatp = 20;
  ffbp = 0.2;
  fbt = 20;
  fmt = 20;
end

model bertram_satin_zhang_smolen_sherman_2004_version01__KATP(time_, IKATP, VK, atp, adp, V)

  // Assignment Rules:
  mgadp := 0.165 * adp;
  adp3m := 0.135 * adp;
  atp4m := 0.05 * atp;
  topo := 0.08 * (1 + 2 * mgadp / (kdd * 1 )) + 0.89 * power(mgadp / (kdd * 1 ), 2 );
  bottomo := power(1 + mgadp / (kdd * 1 ), 2 ) * (1 + adp3m / (ktd * 1 ) + atp4m / (ktt * 1 ));
  katpo := topo / bottomo;
  IKATP := gkatpbar * katpo * (V - VK);

  // Variable initializations:
  VK = -75;
  gkatpbar = 27000;
  kdd = 17;
  ktd = 26;
  ktt = 1;
end

model bertram_satin_zhang_smolen_sherman_2004_version01__nucleotides(time_, atp, adp, c, rgpdh, amp, atot)

  // Assignment Rules:
  atp := 0.5 * (atot - adp + rad * 1 );
  fback := r + y;
  y := vg * (rgpdh / (kg + rgpdh));
  amp := adp * adp / atp;
  rad := root(power(adp - atot, 2 ) - 4 * power(adp, 2 )) / 1;
  ratio := atp / adp;

  // Rate Rules:
  adp' = (atp - adp * exp(fback * (1 - c / r1))) / (taua * 1 );

  // Variable initializations:
  adp = 780;
  taua = 300000;
  r1 = 0.35;
  r = 1;
  vg = 2.2;
  kg = 10;
end

model bertram_satin_zhang_smolen_sherman_2004_version01____main()

  // Sub-modules, and any changes to those submodules:
  environment: bertram_satin_zhang_smolen_sherman_2004_version01__environment(time_);
  membrane: bertram_satin_zhang_smolen_sherman_2004_version01__membrane(V, ICa, IKATP, VK, c, time_);
  calcium_handling: bertram_satin_zhang_smolen_sherman_2004_version01__calcium_handling(time_, c, cer, ICa);
  glycolysis: bertram_satin_zhang_smolen_sherman_2004_version01__glycolysis(time_, rgpdh, atot, pfkbas, f6p, pfk0, fbp);
  pfk: bertram_satin_zhang_smolen_sherman_2004_version01__pfk(time_, pfk0, pfkbas, atp, f6p, fbp, amp);
  KATP: bertram_satin_zhang_smolen_sherman_2004_version01__KATP(time_, IKATP, VK, atp, adp, V);
  nucleotides: bertram_satin_zhang_smolen_sherman_2004_version01__nucleotides(time_, atp, adp, c, rgpdh, amp, atot);
end
