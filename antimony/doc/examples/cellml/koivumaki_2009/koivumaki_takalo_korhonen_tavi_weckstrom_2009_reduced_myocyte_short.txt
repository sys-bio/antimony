//Created by libAntimony v1.3
model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__environment(time_, t_modulo)

  // Assignment Rules:
  t_modulo := rem(time_, 1000 );
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__general_parameters(Acap, V_myo, C_m, F, T, R, CaM_tot, Km_CaM, Ca_o, Na_o, Ca_NSR, J_leak)

  // Variable initializations:
  Acap = 1.534e-4;
  V_myo = 25.84e-6;
  C_m = 1;
  F = 96.5;
  T = 298;
  R = 8.314;
  CaM_tot = 24;
  Km_CaM = 2.38;
  Ca_o = 1000;
  Na_o = 140000;
  Ca_NSR = 760;
  J_leak = 0.0003;
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__action_potential(V, t_modulo)

  // Assignment Rules:
  V := rest + A * power(1 - exp(-(t_modulo) / t1), p) * exp(-(t_modulo) / t2);

  // Variable initializations:
  t1 = 0.5;
  t2 = 8;
  p = 2;
  A = 150;
  rest = -80;
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__calcium_input(Ca_input, t_modulo)

  // Assignment Rules:
  Ca_input := Ca_amp * power(1 - exp(-(tcalcium) / Ca_tau1), Ca_pow) * exp(-(tcalcium) / Ca_tau2);
  tcalcium := piecewise( 0 , t_modulo - 1.2 <= 0 , t_modulo - 1.2 );

  // Variable initializations:
  Ca_tau1 = 1.5;
  Ca_tau2 = 14;
  Ca_pow = 2;
  Ca_amp = 2.9;
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__NCX_current(INaCa, Ca_o, Na_o, Ca_cyt, F, T, R, V)

  // Assignment Rules:
  INaCa := kNaCa / ((power(KmNa, 3 ) + power(Na_o, 3 )) * (KmCa + Ca_o) * (1 + ksat * exp((eta - 1 ) * V * F / (R * T)))) * (exp(eta * V * F / (R * T)) * power(Na_i, 3 ) * Ca_o - exp((eta - 1 ) * V * F / (R * T)) * power(Na_o, 3 ) * Ca_cyt);
  kNaCa := 125 * 2.5;

  // Variable initializations:
  Na_i = 14000;
  KmNa = 87500;
  KmCa = 1380;
  ksat = 0.1;
  eta = 0.35;
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__serca_parameters(SERCA_TOT, CaMKII_reg, PKA_reg, PLB_tot, kplb_pos, kplb_neg, EC_50_fwd, EC_50_rev, PLB_dephosph)

  // Assignment Rules:
  EC_50_fwd := (Kmf_PLBKO + Kmf_PLB * PSR * PLB_dephosph / 1 ) * (1 + 0.27 * CaMKII_reg);
  EC_50_rev := Kmr_PLBKO - Kmr_PLB * PSR * PLB_dephosph / 1;

  // Variable initializations:
  SERCA_TOT = 47;
  CaMKII_reg = 0.1;
  PKA_reg = 0.1;
  PSR = 1;
  Kmf_PLBKO = 0.15;
  Kmf_PLB = 0.15;
  Kmr_PLBKO = 2500;
  Kmr_PLB = 1110;
  PLB_tot = 1;
  kplb_pos = 1;
  kplb_neg = 6.8;
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__transition_parameters(k_cyt_serca, k_serca_cyt, k_serca_sr, k_sr_serca, CaMKII_reg, EC_50_fwd, EC_50_rev)

  // Assignment Rules:
  k_cyt_serca := br_cyt_serca * (1 + 0.7 * CaMKII_reg);
  k_serca_cyt := power(EC_50_fwd, 2 ) * br_cyt_serca;
  k_serca_sr := br_serca_sr * (1 + 0.7 * CaMKII_reg);
  k_sr_serca := br_serca_sr / power(EC_50_rev, 2 );
  br_cyt_serca := 1000 * br_serca_sr;

  // Variable initializations:
  br_serca_sr = 0.00625;
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__calcium_fluxes(J_cyt_serca, J_serca_sr, Ca_cyt, Ca_NSR, SERCA_TOT, k_cyt_serca, k_serca_cyt, k_serca_sr, k_sr_serca, Ca_serca)

  // Assignment Rules:
  J_up := J_cyt_serca - J_serca_sr;
  J_cyt_serca := k_cyt_serca * power(Ca_cyt, 2 ) * (SERCA_TOT - Ca_serca) - k_serca_cyt * Ca_serca;
  J_serca_sr := k_serca_sr * Ca_serca - k_sr_serca * power(Ca_NSR, 2 ) * (SERCA_TOT - Ca_serca);
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__calcium_buffering(LTRPN_tot, kltrpn_pos, kltrpn_neg, J_LTRPN, B_i, CaM_tot, Km_CaM, Ca_cyt, LTRPN)

  // Assignment Rules:
  J_LTRPN := kltrpn_pos * Ca_cyt * (LTRPN_tot - LTRPN) - kltrpn_neg * LTRPN;
  B_i := power(1 + CaM_tot * Km_CaM / power(Km_CaM + Ca_cyt, 2 ), -(1 ));

  // Variable initializations:
  LTRPN_tot = 70;
  kltrpn_pos = 0.1;
  kltrpn_neg = 0.06;
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__differential_equations(time_, Acap, V_myo, C_m, F, J_leak, LTRPN_tot, CaMKII_reg, PKA_reg, PLB_tot, kplb_pos, kplb_neg, kltrpn_pos, kltrpn_neg, B_i, Ca_input, INaCa, J_LTRPN, J_cyt_serca, J_serca_sr, Ca_cyt, LTRPN, PLB_dephosph, Ca_serca)

  // Rate Rules:
  Ca_cyt' = B_i * (INaCa * Acap * C_m / (2 * V_myo * F) - J_cyt_serca + J_leak + Ca_input - J_LTRPN);
  LTRPN' = kltrpn_pos * Ca_cyt * (LTRPN_tot - LTRPN) - kltrpn_neg * LTRPN;
  PLB_dephosph' = kplb_pos * (PLB_tot - PLB_dephosph) - kplb_neg * power(CaMKII_reg + PKA_reg, 2 ) * PLB_dephosph;
  Ca_serca' = J_cyt_serca - J_serca_sr;

  // Variable initializations:
  Ca_cyt = 0.1;
  LTRPN = 11;
  PLB_dephosph = 0.1;
  Ca_serca = 5;
end

model koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short____main()

  // Sub-modules, and any changes to those submodules:
  environment: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__environment(time_, t_modulo);
  general_parameters: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__general_parameters(Acap, V_myo, C_m, F, T, R, CaM_tot, Km_CaM, Ca_o, Na_o, Ca_NSR, J_leak);
  action_potential: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__action_potential(V, t_modulo);
  calcium_input: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__calcium_input(Ca_input, t_modulo);
  NCX_current: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__NCX_current(INaCa, Ca_o, Na_o, Ca_cyt, F, T, R, V);
  serca_parameters: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__serca_parameters(SERCA_TOT, CaMKII_reg, PKA_reg, PLB_tot, kplb_pos, kplb_neg, EC_50_fwd, EC_50_rev, PLB_dephosph);
  transition_parameters: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__transition_parameters(k_cyt_serca, k_serca_cyt, k_serca_sr, k_sr_serca, CaMKII_reg, EC_50_fwd, EC_50_rev);
  calcium_fluxes: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__calcium_fluxes(J_cyt_serca, J_serca_sr, Ca_cyt, Ca_NSR, SERCA_TOT, k_cyt_serca, k_serca_cyt, k_serca_sr, k_sr_serca, Ca_serca);
  calcium_buffering: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__calcium_buffering(LTRPN_tot, kltrpn_pos, kltrpn_neg, J_LTRPN, B_i, CaM_tot, Km_CaM, Ca_cyt, LTRPN);
  differential_equations: koivumaki_takalo_korhonen_tavi_weckstrom_2009_reduced_myocyte_short__differential_equations(time_, Acap, V_myo, C_m, F, J_leak, LTRPN_tot, CaMKII_reg, PKA_reg, PLB_tot, kplb_pos, kplb_neg, kltrpn_pos, kltrpn_neg, B_i, Ca_input, INaCa, J_LTRPN, J_cyt_serca, J_serca_sr, Ca_cyt, LTRPN, PLB_dephosph, Ca_serca);
end
