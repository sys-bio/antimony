//Created by libAntimony v1.4
model bueno_2007__environment(time_, epi, endo, mcell)

  // Variable initializations:
  epi = 1;
  endo = 0;
  mcell = 0;
end

model bueno_2007__membrane(u, time_, J_fi, J_so, J_si)

  // Assignment Rules:
  Vm := V_0 + u * (V_fi - V_0);
  J_stim := piecewise( -(1 ) , ( time_ >= 100) && (time_ <= 101 ), 0 );

  // Rate Rules:
  u' = -((J_fi + J_so + J_si + J_stim));

  // Variable initializations:
  u = 0;
  V_0 = -83;
  V_fi = 2.7;
end

model bueno_2007__m(m, u_m, u, time_)

  // Assignment Rules:
  m := piecewise( 0 , u < u_m , 1 );

  // Variable initializations:
  u_m = 0.3;
end

model bueno_2007__p(p, u_p, u, time_)

  // Assignment Rules:
  p := piecewise( 0 , u < u_p , 1 );

  // Variable initializations:
  u_p = 0.13;
end

model bueno_2007__q(q, epi, endo, mcell, u_q, u, time_)

  // Assignment Rules:
  q := piecewise( 0 , u < u_q , 1 );
  u_q := piecewise( 0.006 , epi == 1 , 0.024 , endo == 1 , 0.1 );
end

model bueno_2007__r(r, epi, endo, mcell, u, time_)

  // Assignment Rules:
  r := piecewise( 0 , u < u_r , 1 );
  u_r := piecewise( 0.006 , epi == 1 , 0.006 , endo == 1 , 0.005 );
end

model bueno_2007__fast_inward_current_v_gate(v, epi, endo, mcell, q, m, u, u_q, time_)

  // Assignment Rules:
  v_inf := piecewise( 1 , u < u_q , 0 );
  tau_v_minus := q * tau_v2_minus + (1 - q) * tau_v1_minus;
  tau_v1_minus := piecewise( 60 , epi == 1 , 75 , endo == 1 , 80 );
  tau_v2_minus := piecewise( 1150 , epi == 1 , 10 , endo == 1 , 1.45 );

  // Rate Rules:
  v' = (1 - m) * (v_inf - v) / tau_v_minus - m * v / tau_v_plus;

  // Variable initializations:
  v = 1;
  tau_v_plus = 1.45;
end

model bueno_2007__fast_inward_current(J_fi, epi, endo, mcell, m, q, u_p, u_m, time_, u, u_q, v)

  // Sub-modules, and any changes to those submodules:
  fast_inward_current_v_gate: bueno_2007__fast_inward_current_v_gate(v, epi, endo, mcell, q, m, u, u_q, time_);

  // Assignment Rules:
  J_fi := -(m) * v * (u - u_m) * (u_u - u) / tau_fi;
  tau_fi := piecewise( 0.11 , epi == 1 , 0.104 , endo == 1 , 0.078 );
  u_u := piecewise( 1.55 , epi == 1 , 1.56 , endo == 1 , 1.61 );
end

model bueno_2007__slow_outward_current(J_so, epi, endo, mcell, r, p, time_, u)

  // Assignment Rules:
  J_so := u * (1 - p) / tau_o + p / tau_so;
  tau_o := (1 - r) * tau_o1 + r * tau_o2;
  tau_o1 := piecewise( 400 , epi == 1 , 470 , endo == 1 , 410 );
  tau_o2 := piecewise( 6 , epi == 1 , 6 , endo == 1 , 7 );
  tau_so := tau_so1 + (tau_so2 - tau_so1) * (1 + tanh(k_so * (u - u_so))) / 2;
  tau_so1 := piecewise( 30.02 , epi == 1 , 40 , endo == 1 , 91 );
  tau_so2 := piecewise( 0.996 , epi == 1 , 1.2 , endo == 1 , 0.8 );
  k_so := piecewise( 2.046 , epi == 1 , 2 , endo == 1 , 2.1 );
  u_so := piecewise( 0.65 , epi == 1 , 0.65 , endo == 1 , 0.6 );
end

model bueno_2007__slow_inward_current_w_gate(w, epi, endo, mcell, r, u, time_)

  // Assignment Rules:
  w_inf := (1 - r) * (1 - u * 1 / tau_winf) + r * wstar_inf;
  tau_winf := piecewise( 0.07 , epi == 1 , 0.0273 , endo == 1 , 0.01 );
  wstar_inf := piecewise( 0.94 , epi == 1 , 0.78 , endo == 1 , 0.5 );
  tau_w_minus := tau_w1_minus + (tau_w2_minus - tau_w1_minus) * (1 + tanh(k_w_minus * (u - u_w_minus))) / 2;
  tau_w1_minus := piecewise( 60 , epi == 1 , 6 , endo == 1 , 70 );
  tau_w2_minus := piecewise( 15 , epi == 1 , 140 , endo == 1 , 8 );
  k_w_minus := piecewise( 65 , epi == 1 , 200 , endo == 1 , 200 );
  u_w_minus := piecewise( 0.03 , epi == 1 , 0.016 , endo == 1 , 0.016 );
  tau_w_plus := piecewise( 200 , epi == 1 , 280 , endo == 1 , 280 );

  // Rate Rules:
  w' = (1 - r) * (w_inf - w) / tau_w_minus - r * w / tau_w_plus;

  // Variable initializations:
  w = 1;
end

model bueno_2007__slow_inward_current_s_gate(s, epi, endo, mcell, p, u, time_)

  // Assignment Rules:
  tau_s := (1 - p) * tau_s1 + p * tau_s2;
  tau_s2 := piecewise( 16 , epi == 1 , 2 , endo == 1 , 4 );

  // Rate Rules:
  s' = ((1 + tanh(k_s * (u - u_s))) / 2 - s) / tau_s;

  // Variable initializations:
  s = 0;
  tau_s1 = 2.7342;
  k_s = 2.0994;
  u_s = 0.9087;
end

model bueno_2007__slow_inward_current(J_si, epi, endo, mcell, p, r, time_, u, w, s)

  // Sub-modules, and any changes to those submodules:
  slow_inward_current_w_gate: bueno_2007__slow_inward_current_w_gate(w, epi, endo, mcell, r, u, time_);
  slow_inward_current_s_gate: bueno_2007__slow_inward_current_s_gate(s, epi, endo, mcell, p, u, time_);

  // Assignment Rules:
  J_si := -(p) * w * s / tau_si;
  tau_si := piecewise( 1.8875 , epi == 1 , 2.9013 , endo == 1 , 3.3849 );
end

model bueno_2007____main()

  // Sub-modules, and any changes to those submodules:
  environment: bueno_2007__environment(time_, epi, endo, mcell);
  membrane: bueno_2007__membrane(u, time_, J_fi, J_so, J_si);
  m: bueno_2007__m(m0, u_m, u, time_);
  p: bueno_2007__p(p0, u_p, u, time_);
  q: bueno_2007__q(q0, epi, endo, mcell, u_q, u, time_);
  r: bueno_2007__r(r0, epi, endo, mcell, u, time_);
  fast_inward_current: bueno_2007__fast_inward_current(J_fi, epi, endo, mcell, m0, q0, u_p, u_m, time_, u, u_q, v);
  slow_outward_current: bueno_2007__slow_outward_current(J_so, epi, endo, mcell, r0, p0, time_, u);
  slow_inward_current: bueno_2007__slow_inward_current(J_si, epi, endo, mcell, p0, r0, time_, u, w, s);
end
