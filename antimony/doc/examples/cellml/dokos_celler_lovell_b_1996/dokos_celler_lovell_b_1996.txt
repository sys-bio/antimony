//Created by libAntimony v1.3
model dokos_celler_lovell_1996_version02__environment(time_)
end

model dokos_celler_lovell_1996_version02__constants(R, T, F)

  // Variable initializations:
  R = 8.32;
  T = 310.0;
  F = 96.49;
end

model dokos_celler_lovell_1996_version02__membrane(E, time_, i_CaL, i_CaT, i_Na, i_K, i_f, i_p, i_NaCa, i_bNa, i_KACh)

  // Assignment Rules:
  i_tot := i_CaL + i_CaT + i_Na + i_K + i_f + i_p + i_NaCa + i_bNa + i_KACh;

  // Rate Rules:
  E' = -( i_tot ) / C;

  // Variable initializations:
  E = -64.9;
  C = 32.0;
end

model dokos_celler_lovell_1996_version02__reversal_potentials(E_Ca, E_Na, E_K, R, T, F, Cai, Cao, Nai, Nao, Ki, Ko)

  // Assignment Rules:
  E_Ca := R * T / ( 2.0 * F ) * ln( Cao / Cai );
  E_Na := R * T / F * ln( Nao / Nai );
  E_K := R * T / F * ln( Ko / Ki );
end

model dokos_celler_lovell_1996_version02__L_type_calcium_current_d_gate(d, E, time_)

  // Assignment Rules:
  d_infinity := 1.0 / ( 1.0 + exp(( E + 6.6 ) / -6.6 ));

  // Rate Rules:
  d' = ( d_infinity - d ) / tau_d;

  // Variable initializations:
  d = 0.0001;
  tau_d = 0.002;
end

model dokos_celler_lovell_1996_version02__L_type_calcium_current_f_gate(f, E, time_)

  // Assignment Rules:
  f_infinity := 1.0 / ( 1.0 + exp(( E + 25.0 ) / 6.0 ));
  tau_f := 0.031 + 1.0 / ( 1.0 + exp(( E + 37.6 ) / 8.1 ));

  // Rate Rules:
  f' = ( f_infinity - f ) / tau_f;

  // Variable initializations:
  f = 0.1505;
end

model dokos_celler_lovell_1996_version02__L_type_calcium_current_f2_gate(f2, E, Cai, time_)

  // Rate Rules:
  f2' = alpha_f2 * ( 1.0 - f2 ) - beta_f2 * Cai * f2;

  // Variable initializations:
  f2 = 0.2190;
  alpha_f2 = 3.0;
  beta_f2 = 40000.0;
end

model dokos_celler_lovell_1996_version02__L_type_calcium_current_w_gate(w, ACh, time_)

  // Assignment Rules:
  alpha_w := ( 0.0033 * ACh + 0.0000006 ) / ( ACh + 0.000036 );
  beta_w := 0.0037 * ACh / ( ACh + 0.000036 );

  // Rate Rules:
  w' = alpha_w * ( 1.0 - w ) - beta_w * w;
end

model dokos_celler_lovell_1996_version02__L_type_calcium_current(i_CaL, E_Ca, time_, E, Cai, ACh, d, f, f2, w)

  // Sub-modules, and any changes to those submodules:
  L_type_calcium_current_d_gate: dokos_celler_lovell_1996_version02__L_type_calcium_current_d_gate(d, E, time_);
  L_type_calcium_current_f_gate: dokos_celler_lovell_1996_version02__L_type_calcium_current_f_gate(f, E, time_);
  L_type_calcium_current_f2_gate: dokos_celler_lovell_1996_version02__L_type_calcium_current_f2_gate(f2, E, Cai, time_);
  L_type_calcium_current_w_gate: dokos_celler_lovell_1996_version02__L_type_calcium_current_w_gate(w, ACh, time_);

  // Assignment Rules:
  i_CaL := w * g_CaL * d * f * f2 * ( E + -( E_Ca ) + 75.0 );

  // Variable initializations:
  g_CaL = 400.0;
end

model dokos_celler_lovell_1996_version02__T_type_calcium_current_d_gate(d, E, time_)

  // Assignment Rules:
  d_infinity := 1.0 / ( 1.0 + exp(( E + 23.0 ) / -6.1 ));
  tau_d := 0.0006 + 0.0054 / ( 1.0 + exp( 0.03 * ( E + 100.0 )));

  // Rate Rules:
  d' = ( d_infinity - d ) / tau_d;

  // Variable initializations:
  d = 0.0010;
end

model dokos_celler_lovell_1996_version02__T_type_calcium_current_f_gate(f, E, time_)

  // Assignment Rules:
  f_infinity := 1.0 / ( 1.0 + exp(( E + 75.0 ) / 6.6 ));
  tau_f := 0.001 + 0.04 / ( 1.0 + exp( 0.08 * ( E + 65.0 )));

  // Rate Rules:
  f' = ( f_infinity - f ) / tau_f;

  // Variable initializations:
  f = 0.1328;
end

model dokos_celler_lovell_1996_version02__T_type_calcium_current(i_CaT, E_Ca, time_, E, d, f)

  // Sub-modules, and any changes to those submodules:
  T_type_calcium_current_d_gate: dokos_celler_lovell_1996_version02__T_type_calcium_current_d_gate(d, E, time_);
  T_type_calcium_current_f_gate: dokos_celler_lovell_1996_version02__T_type_calcium_current_f_gate(f, E, time_);

  // Assignment Rules:
  i_CaT := g_CaT * d * f * ( E + -( E_Ca ) + 75.0 );

  // Variable initializations:
  g_CaT = 85.0;
end

model dokos_celler_lovell_1996_version02__fast_sodium_current_m_gate(m, E, time_)

  // Assignment Rules:
  alpha_m := 200.0 * ( E + 34.3 ) / ( 1.0 - exp( -0.09 * ( E + 34.3 )));
  beta_m := 8000.0 * exp( -0.15 * ( E + 56.2 ));

  // Rate Rules:
  m' = alpha_m * ( 1.0 - m ) - beta_m * m;

  // Variable initializations:
  m = 0.0139;
end

model dokos_celler_lovell_1996_version02__fast_sodium_current_h_gate(h, E, time_)

  // Assignment Rules:
  alpha_h := 32.4 * exp( -0.14 * ( E + 93.4 ));
  beta_h := 709.0 / ( 1.0 + 4.2 * exp( -0.06 * ( E + 45.4 )));

  // Rate Rules:
  h' = alpha_h * ( 1.0 - h ) - beta_h * h;

  // Variable initializations:
  h = 0.0087;
end

model dokos_celler_lovell_1996_version02__fast_sodium_current(i_Na, E_Na, time_, E, m, h)

  // Sub-modules, and any changes to those submodules:
  fast_sodium_current_m_gate: dokos_celler_lovell_1996_version02__fast_sodium_current_m_gate(m, E, time_);
  fast_sodium_current_h_gate: dokos_celler_lovell_1996_version02__fast_sodium_current_h_gate(h, E, time_);

  // Assignment Rules:
  i_Na := g_Na * power( m , 3.0 ) * h * ( E - E_Na );

  // Variable initializations:
  g_Na = 250.0;
end

model dokos_celler_lovell_1996_version02__delayed_rectifying_potassium_current_x_gate(x, E, time_)

  // Assignment Rules:
  x_infinity := 1.0 / ( 1.0 + exp(( E + 25.1 ) / -7.4 ));
  tau_x := 1.0 / ( 17.0 * exp( 0.0398 * E ) + 0.211 * exp( -0.051 * E ));

  // Rate Rules:
  x' = ( x_infinity - x ) / tau_x;

  // Variable initializations:
  x = 0.5682;
end

model dokos_celler_lovell_1996_version02__delayed_rectifying_potassium_current(i_K, i_KK, i_KNa, R, T, F, Ko, Ki, Nao, Nai, time_, E, x)

  // Sub-modules, and any changes to those submodules:
  delayed_rectifying_potassium_current_x_gate: dokos_celler_lovell_1996_version02__delayed_rectifying_potassium_current_x_gate(x, E, time_);

  // Assignment Rules:
  i_K := i_KK + i_KNa;
  i_KK := x * Kk * power( Ko , 0.59 ) * ( Ki - Ko * exp(-( E ) * F / ( R * T )));
  i_KNa := x * Kk * P_KNa * power( Ko , 0.59 ) * ( Nai - Nao * exp(-( E ) * F / ( R * T )));

  // Variable initializations:
  Kk = 0.26;
  P_KNa = 0.035;
end

model dokos_celler_lovell_1996_version02__hyperpolarising_activated_current_y_gate(y, ACh, E, time_)

  // Assignment Rules:
  alpha_y := 0.36 * ( E + 137.8 + power( v , 4.0 ) * E_shift_max ) / (exp( 0.0666 * ( E + 137.8 + power( v , 4.0 ) * E_shift_max )) - 1.0 );
  beta_y := 0.1 * ( E + 76.3 + power( v , 4.0 ) * E_shift_max ) / ( 1.0 - exp( -0.21 * ( E + 76.3 + power( v , 4.0 ) * E_shift_max )));
  alpha_v := 4.0 * ACh / ( ACh + 0.00008 );
  beta_v := 0.00001 / ( ACh + 0.00008 );

  // Rate Rules:
  y' = alpha_y * ( 1.0 - y ) - beta_y * y;
  v' = alpha_v * ( 1.0 - v ) - beta_v * v;

  // Variable initializations:
  y = 0.0287;
  E_shift_max = 10.0;
end

model dokos_celler_lovell_1996_version02__hyperpolarising_activated_current(i_f, i_fNa, i_fK, E_Na, E_K, Ko, time_, E, ACh, y)

  // Sub-modules, and any changes to those submodules:
  hyperpolarising_activated_current_y_gate: dokos_celler_lovell_1996_version02__hyperpolarising_activated_current_y_gate(y, ACh, E, time_);

  // Assignment Rules:
  i_f := i_fK + i_fNa;
  i_fNa := y * (power( Ko , 1.83 ) / (power( Ko , 1.83 ) + power( Kmf , 1.83 ))) * ( g_fNa * ( Ko * ( E - E_Na )));
  i_fK := y * (power( Ko , 1.83 ) / (power( Ko , 1.83 ) + power( Kmf , 1.83 ))) * ( g_fK * ( Ko * ( E - E_K )));

  // Variable initializations:
  Kmf = 10.3;
  g_fNa = 8.1;
  g_fK = 13.5;
end

model dokos_celler_lovell_1996_version02__sodium_potassium_pump(i_p, Ko, Nai, time_, E)

  // Assignment Rules:
  i_p := i_pmax * ( Nai / ( Nai + KmNa )) * ( Ko / ( Ko + KmK )) * ( 1.0 - power(( E - 40.0 ) / 211.0 , 2.0 ));

  // Variable initializations:
  KmNa = 40.0;
  KmK = 1.0;
  i_pmax = 226.0;
end

model dokos_celler_lovell_1996_version02__sodium_calcium_exchange_current(i_NaCa, Cao, Nao, Cai, Nai, time_, R, T, F, E)

  // Assignment Rules:
  i_NaCa := kNaCa * (( x2 * k21 - x1 * k12 ) / ( x1 + x2 + x3 + x4 ));
  x1 := k41 * k34 * ( k23 + k21 ) + k21 * k32 * ( k43 + k41 );
  x2 := k32 * k43 * ( k14 + k12 ) + k41 * k12 * ( k34 + k32 );
  x3 := k14 * k43 * ( k23 + k21 ) + k12 * k23 * ( k43 + k41 );
  x4 := k23 * k34 * ( k14 + k12 ) + k14 * k21 * ( k34 + k32 );
  k41 := exp(-(( Qn * E * F )) / ( 2.0 * R * T ));
  k34 := Nao / ( K3no + Nao );
  k23 := power( Nao , 2.0 ) / ( K1no * K2no ) * (power( Nao , 3.0 ) / ( K1no * K2no * K3no )) * exp(-(( Qn * E * F )) / ( 2.0 * R * T )) / do;
  k21 := Cao / Kco * exp( Qco * E * F / ( R * T )) / do;
  k32 := exp( Qn * E * F / ( 2.0 * R * T ));
  k43 := Nai / ( K3ni + Nai );
  k12 := Cai / Kci * exp(-( Qci ) * E * F / ( R * T )) / di;
  k14 := (power( Nai , 2.0 ) / ( K1ni * K2ni ) + power( Nai , 3.0 ) / ( K1ni * K2ni * K3ni )) * exp( Qn * E * F / ( R * T )) / di;
  do := 1.0 + Cao / Kco + Cao / Kco * exp(-(( Qco * E * F )) / ( R * T )) + Nao / K1no + power( Nao , 2.0 ) / ( K1no * K2no ) + power( Nao , 3.0 ) / ( K1no * K2no * K3no );
  di := 1.0 + Cai / Kci + Cai / Kci * exp(-(( Qci * E * F )) / ( R * T )) + Cai * Nai / ( Kci * Kcni ) + Nai / K1ni + power( Nai , 2.0 ) / ( K1ni * K2ni ) + power( Nai , 3.0 ) / ( K1ni * K2ni * K3ni );

  // Variable initializations:
  kNaCa = 4000.0;
  Qci = 0.1369;
  Qn = 0.4315;
  Qco = 0.0;
  K3ni = 26.44;
  Kci = 0.0207;
  K1ni = 395.3;
  K2ni = 2.289;
  Kcni = 26.44;
  K3no = 4.663;
  K1no = 1628.0;
  K2no = 561.4;
  Kco = 3.663;
end

model dokos_celler_lovell_1996_version02__background_sodium_current(i_bNa, time_, E, E_Na)

  // Assignment Rules:
  i_bNa := g_Nab * ( E - E_Na );

  // Variable initializations:
  g_Nab = 0.24;
end

model dokos_celler_lovell_1996_version02__ACh_activated_potassium_current_u_gate(u, ACh, time_)

  // Assignment Rules:
  alpha_u := 4.7 * ACh / ( ACh + 0.00012 );
  beta_u := 0.00027 / ( ACh + 0.00012 );

  // Rate Rules:
  u' = alpha_u * ( 1.0 - u ) - beta_u * u;
end

model dokos_celler_lovell_1996_version02__ACh_activated_potassium_current(i_KACh, R, T, F, Ko, Ki, E, time_, ACh, u)

  // Sub-modules, and any changes to those submodules:
  ACh_activated_potassium_current_u_gate: dokos_celler_lovell_1996_version02__ACh_activated_potassium_current_u_gate(u, ACh, time_);

  // Assignment Rules:
  i_KACh := ( KbK + power( u , 4.0 ) * KKACh ) * power( Ko , 0.41 ) * ( Ki - Ko * exp(-( E ) * F / ( R * T )));

  // Variable initializations:
  KbK = 0.07;
  KKACh = 2.0;
end

model dokos_celler_lovell_1996_version02__ACh_kinetics_in_neuroeffector_junction(ACh, time_)

  // Rate Rules:
  ACh' = -( k_H ) * ACh - k_D * ( ACh - ACh_ex );
  ACh_ms' = k_H / F_ms * ACh + k_E / F_ms * ACh_ex;
  ACh_ex' = -(( k_E / F_ex )) * ACh - k_D / F_ms * ( ACh_ex - ACh );

  // Variable initializations:
  k1 = 0.01;
  k2 = 0.0005;
  F_ms = 1.0;
  F_ex = 1.0;
  k_D = 0.5;
  k_E = 0.5;
  k_H = 14.0;
end

model dokos_celler_lovell_1996_version02__sarcoplasmic_reticulum_kinetics(i_up, i_tr, i_rel, V_rel, V_up, time_, F, Cai, Caup, Carel)

  // Assignment Rules:
  i_up := i_up_max * (power( Cai , 2.0 ) / (power( Cai , 2.0 ) + power( KmCaup , 2.0 )));
  i_tr := alpha_tr * Caup;
  i_rel := alpha_rel * Carel * (power( Cai , 2.0 ) / (power( Cai , 2.0 ) + power( KmCarel , 2.0 )));
  alpha_rel := 2.0 * V_rel * F / tau_rel;
  alpha_tr := 2.0 * V_rel * F / tau_rel;

  // Variable initializations:
  V_rel = 0.015;
  V_up = 0.035;
  i_up_max = 21.2;
  KmCaup = 0.0005;
  KmCarel = 0.001;
  tau_rel = 0.005;
  tau_tr = 0.4;
end

model dokos_celler_lovell_1996_version02__ion_concentrations(Cai, Cao, Caup, Carel, Nai, Nao, Ki, Ko, time_, F, i_bNa, i_fNa, i_Na, i_p, i_NaCa, i_KNa, i_KK, i_fK, i_KACh, i_CaL, i_CaT, i_up, i_rel, i_tr, V_rel, V_up)

  // Rate Rules:
  Cai' = -(( i_CaL + i_CaT + -2.0 * i_NaCa + i_up + -( i_rel ))) / ( 2.0 * F * V_i );
  Cao' = ( i_CaL + i_CaT + -2.0 * i_NaCa ) / ( 2.0 * F * V_e ) + ( Cab - Cao ) / tau_b;
  Caup' = ( i_up - i_tr ) / ( 2.0 * V_up * F );
  Carel' = ( i_tr - i_rel ) / ( 2.0 * V_rel * F );
  Nai' = -(( i_bNa + i_fNa + i_Na + 3.0 * i_p + 3.0 * i_NaCa + i_KNa )) / ( F * V_i );
  Nao' = ( i_bNa + i_fNa + i_Na + 3.0 * i_p + 3.0 * i_NaCa + i_KNa ) / ( F * V_e ) + ( Nab - Nao ) / tau_b;
  Ki' = -(( i_KK + i_fK + -2.0 * i_p + i_KACh )) / ( F * V_i );
  Ko' = ( i_KK + i_fK + -2.0 * i_p + i_KACh ) / ( F * V_e ) + ( Kb - Ko ) / tau_b;

  // Variable initializations:
  Cai = 0.000034;
  Cao = 2.0004;
  Caup = 0.5832;
  Carel = 0.1101;
  Nai = 7.4994;
  Nao = 139.9929;
  Ki = 140.0073;
  Ko = 5.4243;
  V_i = 2.5;
  V_e = 0.5;
  tau_b = 0.1;
  Nab = 140.0;
  Cab = 2.0;
  Kb = 5.4;
end

model dokos_celler_lovell_1996_version02____main()

  // Sub-modules, and any changes to those submodules:
  environment: dokos_celler_lovell_1996_version02__environment(time_);
  constants: dokos_celler_lovell_1996_version02__constants(R, T, F);
  membrane: dokos_celler_lovell_1996_version02__membrane(E, time_, i_CaL, i_CaT, i_Na, i_K, i_f, i_p, i_NaCa, i_bNa, i_KACh);
  reversal_potentials: dokos_celler_lovell_1996_version02__reversal_potentials(E_Ca, E_Na, E_K, R, T, F, Cai, Cao, Nai, Nao, Ki, Ko);
  L_type_calcium_current: dokos_celler_lovell_1996_version02__L_type_calcium_current(i_CaL, E_Ca, time_, E, Cai, ACh, d, f, f2, w);
  T_type_calcium_current: dokos_celler_lovell_1996_version02__T_type_calcium_current(i_CaT, E_Ca, time_, E, d0, f0);
  fast_sodium_current: dokos_celler_lovell_1996_version02__fast_sodium_current(i_Na, E_Na, time_, E, m, h);
  delayed_rectifying_potassium_current: dokos_celler_lovell_1996_version02__delayed_rectifying_potassium_current(i_K, i_KK, i_KNa, R, T, F, Ko, Ki, Nao, Nai, time_, E, x);
  hyperpolarising_activated_current: dokos_celler_lovell_1996_version02__hyperpolarising_activated_current(i_f, i_fNa, i_fK, E_Na, E_K, Ko, time_, E, ACh, y);
  sodium_potassium_pump: dokos_celler_lovell_1996_version02__sodium_potassium_pump(i_p, Ko, Nai, time_, E);
  sodium_calcium_exchange_current: dokos_celler_lovell_1996_version02__sodium_calcium_exchange_current(i_NaCa, Cao, Nao, Cai, Nai, time_, R, T, F, E);
  background_sodium_current: dokos_celler_lovell_1996_version02__background_sodium_current(i_bNa, time_, E, E_Na);
  ACh_activated_potassium_current: dokos_celler_lovell_1996_version02__ACh_activated_potassium_current(i_KACh, R, T, F, Ko, Ki, E, time_, ACh, u);
  ACh_kinetics_in_neuroeffector_junction: dokos_celler_lovell_1996_version02__ACh_kinetics_in_neuroeffector_junction(ACh, time_);
  sarcoplasmic_reticulum_kinetics: dokos_celler_lovell_1996_version02__sarcoplasmic_reticulum_kinetics(i_up, i_tr, i_rel, V_rel, V_up, time_, F, Cai, Caup, Carel);
  ion_concentrations: dokos_celler_lovell_1996_version02__ion_concentrations(Cai, Cao, Caup, Carel, Nai, Nao, Ki, Ko, time_, F, i_bNa, i_fNa, i_Na, i_p, i_NaCa, i_KNa, i_KK, i_fK, i_KACh, i_CaL, i_CaT, i_up, i_rel, i_tr, V_rel, V_up);
end
