//Created by libAntimony v1.4
model phillips_2008__environment(time_)
end

model phillips_2008__v(Qv, Vv, Qm, Qmax, D, theta, sigma, time_)

  // Assignment Rules:
  Qv := Qmax / (1 + exp(-((Vv - theta)) / sigma));

  // Rate Rules:
  Vv' = piecewise( 0.0 , ( time_ >= awake_start) && (time_ < awake_end ), (v_vm * Qm + D - Vv) / (tau_v / 3600 ) );

  // Variable initializations:
  Vv = -12.5;
  tau_v = 10.0;
  v_vm = -2.1;
  awake_start = 167.04;
  awake_end = 240.0;
end

model phillips_2008__m(Qm, Vm, Qmax, theta, sigma, Qv, time_)

  // Assignment Rules:
  Qm := Qmax / (1 + exp(-((Vm - theta)) / sigma));

  // Rate Rules:
  Vm' = piecewise( 0.0 , ( time_ >= awake_start) && (time_ < awake_end ), (A + v_mv * Qv - Vm) / (tau_m / 3600 ) );

  // Variable initializations:
  Vm = 0.0;
  tau_m = 10.0;
  v_mv = -1.8;
  A = 1.3;
  awake_start = 160.0;
  awake_end = 240.0;
end

model phillips_2008__H(H, Qm, time_)

  // Rate Rules:
  H' = (mu * Qm - H) / chi;

  // Variable initializations:
  H = 15.0;
  chi = 45.0;
  mu = 4.4;
end

model phillips_2008__D(D, H, time_)

  // Assignment Rules:
  D := v_vc * C + v_vh * H;
  C := c0 + cos(omega * (time_ - alpha));
  omega := 2 * pi / 24;

  // Variable initializations:
  c0 = 4.5;
  alpha = 0;
  v_vc = -2.9;
  v_vh = 1.0;
end

model phillips_2008__model_parameters(Qmax, theta, sigma)

  // Variable initializations:
  Qmax = 100.0;
  theta = 10.0;
  sigma = 3.0;
end

model phillips_2008____main()

  // Sub-modules, and any changes to those submodules:
  environment: phillips_2008__environment(time_);
  v: phillips_2008__v(Qv, Vv, Qm, Qmax, D0, theta, sigma, time_);
  m: phillips_2008__m(Qm, Vm, Qmax, theta, sigma, Qv, time_);
  H: phillips_2008__H(H0, Qm, time_);
  D: phillips_2008__D(D0, H0, time_);
  model_parameters: phillips_2008__model_parameters(Qmax, theta, sigma);
end
