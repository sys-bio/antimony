//Created by libAntimony v1.4
model marhl_schuster_brumen_heinrich_1997_version01__environment(time_)
end

model marhl_schuster_brumen_heinrich_1997_version01__free_protein_calcium_binding_sites(CaPr, Pr, Pr_tot, k_plus, k_minus, time_, Ca_cyt)

  // Assignment Rules:
  CaPr := Pr_tot - Pr;

  // Rate Rules:
  Pr' = k_minus * CaPr - k_plus * Ca_cyt * Pr;
end

model marhl_schuster_brumen_heinrich_1997_version01__cytosolic_calcium(Ca_cyt, k_plus, k_minus, Pr, CaPr, J_ch, J_leak, J_pump, time_)

  // Rate Rules:
  Ca_cyt' = J_ch + J_leak + k_minus * CaPr - ( J_pump + k_plus * Ca_cyt * Pr );
end

model marhl_schuster_brumen_heinrich_1997_version01__ER_calcium(Ca_ER, rho, Pr, Pr_tot, Ca_cyt)

  // Assignment Rules:
  Ca_ER := ( Ca_tot - ( Ca_cyt + ( Pr_tot - Pr ))) / rho;

  // Variable initializations:
  Ca_tot = 45.0;
end

model marhl_schuster_brumen_heinrich_1997_version01__potential_difference(delta_psi, rho, R, T, F, Ca_cyt, Pr)

  // Assignment Rules:
  delta_psi := R * T / F * ln((-( b ) - power(power( b , 2.0 ) - 4.0 * a * c , 0.5 )) / ( 2.0 * a ));
  a := rho * ( 2.0 * Ca_cyt - ( 2.0 * Pr + A_tot ));
  b := C_tot - A_tot + 2.0 * ( Ca_cyt - Pr ) * ( 1.0 + power( rho , 2.0 ));
  c := rho * ( 2.0 * Ca_cyt - 2.0 * Pr + C_tot );

  // Variable initializations:
  C_tot = 5.0E3;
  A_tot = 3.89E3;
end

model marhl_schuster_brumen_heinrich_1997_version01__calcium_reversal_potential(E_Ca, R, T, F, Ca_cyt, Ca_ER)

  // Assignment Rules:
  E_Ca := R * T / ( 2.0 * F ) * ln( Ca_ER / Ca_cyt );
end

model marhl_schuster_brumen_heinrich_1997_version01__flux_through_the_channels(J_ch, F, E_Ca, delta_psi, Ca_cyt)

  // Assignment Rules:
  J_ch := k_ch * ( E_Ca - delta_psi );
  g_Ca := g_Ca_max * S * power( Ca_cyt / K_Ca , 2.0 ) / ( 1.0 + power( Ca_cyt / K_Ca , 2.0 ));
  k_ch := g_Ca / ( 2.0 * F * Vcyt );

  // Variable initializations:
  S = 6.16E-3;
  g_Ca_max = 100.0;
  K_Ca = 5.0;
  Vcyt = 5.84E-11;
end

model marhl_schuster_brumen_heinrich_1997_version01__calcium_pump(J_pump, Ca_cyt)

  // Assignment Rules:
  J_pump := k_pump * Ca_cyt;

  // Variable initializations:
  k_pump = 76.0;
end

model marhl_schuster_brumen_heinrich_1997_version01__leak_flux(J_leak, E_Ca, delta_psi)

  // Assignment Rules:
  J_leak := k_leak * ( E_Ca - delta_psi );

  // Variable initializations:
  k_leak = 10.0;
end

model marhl_schuster_brumen_heinrich_1997_version01__model_parameters(Pr_tot, R, T, F, rho, k_plus, k_minus)

  // Variable initializations:
  Pr_tot = 600.0;
  R = 8.3143;
  T = 310.0;
  F = 96.4867;
  rho = 0.01;
  k_plus = 0.1;
  k_minus = 0.5;
end

model marhl_schuster_brumen_heinrich_1997_version01____main()

  // Sub-modules, and any changes to those submodules:
  environment: marhl_schuster_brumen_heinrich_1997_version01__environment(time_);
  free_protein_calcium_binding_sites: marhl_schuster_brumen_heinrich_1997_version01__free_protein_calcium_binding_sites(CaPr, Pr, Pr_tot, k_plus, k_minus, time_, Ca_cyt);
  cytosolic_calcium: marhl_schuster_brumen_heinrich_1997_version01__cytosolic_calcium(Ca_cyt, k_plus, k_minus, Pr, CaPr, J_ch, J_leak, J_pump, time_);
  ER_calcium: marhl_schuster_brumen_heinrich_1997_version01__ER_calcium(Ca_ER, rho, Pr, Pr_tot, Ca_cyt);
  potential_difference: marhl_schuster_brumen_heinrich_1997_version01__potential_difference(delta_psi, rho, R, T, F, Ca_cyt, Pr);
  calcium_reversal_potential: marhl_schuster_brumen_heinrich_1997_version01__calcium_reversal_potential(E_Ca, R, T, F, Ca_cyt, Ca_ER);
  flux_through_the_channels: marhl_schuster_brumen_heinrich_1997_version01__flux_through_the_channels(J_ch, F, E_Ca, delta_psi, Ca_cyt);
  calcium_pump: marhl_schuster_brumen_heinrich_1997_version01__calcium_pump(J_pump, Ca_cyt);
  leak_flux: marhl_schuster_brumen_heinrich_1997_version01__leak_flux(J_leak, E_Ca, delta_psi);
  model_parameters: marhl_schuster_brumen_heinrich_1997_version01__model_parameters(Pr_tot, R, T, F, rho, k_plus, k_minus);
end
