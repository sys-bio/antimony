//Created by libAntimony v1.4
model nelson_1995b__environment(time_)
end

model nelson_1995b__uninfected_CD4(time_, mu_T, T_1, k_1, V, k_1_, V_, T)

  // Assignment Rules:
  s_V := s_0 * theta / (theta + V);

  // Rate Rules:
  T' = s_V - mu_T * T + r * T * (1 - (T + T_1) / T_max) - k_1 * V * T - k_1_ * V_ * T;

  // Variable initializations:
  mu_T = 0.02;
  r = 0.03;
  T_max = 1500;
  s_0 = 10;
  theta = 1;
  T = 1000;
end

model nelson_1995b__latently_infected_CD4(time_, k_1, V, T, k_1_, V_, mu_T, k_2, T_1)

  // Rate Rules:
  T_1' = k_1 * V * T + k_1_ * V_ * T - mu_T * T_1 - k_2 * T_1;

  // Variable initializations:
  k_2 = 0.017;
  T_1 = 0;
end

model nelson_1995b__actively_infected_CD4(time_, k_2, T_1, k_1D, D, mu_b, T_2)

  // Rate Rules:
  T_2' = k_2 * T_1 - k_1D * D * T_2 - mu_b * T_2;

  // Variable initializations:
  k_1D = 2.4E-5;
  mu_b = 0.24;
  T_2 = 0;
end

model nelson_1995b__actively_coinfected_CD4(time_, k_1D, D, T_2, k_s, mu_bD, T_D2)

  // Rate Rules:
  T_D2' = k_1D * D * T_2 - k_s * T_D2 - mu_bD * T_D2;

  // Variable initializations:
  k_s = 0.48;
  mu_bD = 0.12;
  T_D2 = 0;
end

model nelson_1995b__stably_coinfected_CD4(time_, k_s, T_D2, T_D1)

  // Rate Rules:
  T_D1' = k_s * T_D2 - mu_TD * T_D1;

  // Variable initializations:
  mu_TD = 0.02;
  T_D1 = 0;
end

model nelson_1995b__DIV(time_, mu_bD, T_D2, T_D1, D, N_t, mu_b)

  // Assignment Rules:
  N_D_t := 0.2 * N_t;
  pi_D_t := 0.5 * mu_b * N_t;
  D := piecewise( 0 , time_ < t_DIV , D_ode );

  // Rate Rules:
  D_ode' = piecewise( D_0 / t_DIV , time_ < t_DIV , N_D_t * mu_bD * T_D2 + pi_D_t * T_D1 - mu_D * D_ode );

  // Variable initializations:
  mu_D = 0.76;
  t_DIV = 2557;
  D_ode = 0;
  D_0 = 0.1;
end

model nelson_1995b__HIV1(time_, N_t, mu_b, T_2, mu_bD, T_D2, k_1, T, mu_V, V)

  // Assignment Rules:
  N_2_t := 0.1 * N_t;

  // Rate Rules:
  V' = N_t * mu_b * T_2 + N_2_t * mu_bD * T_D2 - k_1 * V * T - mu_V * V;

  // Variable initializations:
  k_1 = 2.4E-5;
  mu_V = 2.4;
  V = 1E-3;
end

model nelson_1995b__hybrid_HIV1(time_, mu_bD, T_D2, T_D1, mu_V, k_1_, T, V_, mu_b, N_t)

  // Assignment Rules:
  N_t_ := 0.1 * N_t;
  pi_t_ := 0.01 * mu_b * N_t;

  // Rate Rules:
  V_' = N_t_ * mu_bD * T_D2 + pi_t_ * T_D1 - mu_V * V_ - k_1_ * T * V_;

  // Variable initializations:
  k_1_ = 2.4E-7;
  V_ = 0;
end

model nelson_1995b__production_function(time_, N_t)

  // Assignment Rules:
  N_t := N_0 * (1 + gamma * (power(time_, 2 ) / (power(time_, 2 ) + power(t_c, 2 ))));

  // Variable initializations:
  N_0 = 300;
  gamma = 25;
  t_c = 7305;
end

model nelson_1995b__cell_population(T, T_1, T_2, T_D2, T_D1)

  // Assignment Rules:
  T_tot := T + T_1 + T_2 + T_D2 + T_D1;
end

model nelson_1995b____main()

  // Sub-modules, and any changes to those submodules:
  environment: nelson_1995b__environment(time_);
  uninfected_CD4: nelson_1995b__uninfected_CD4(time_, mu_T, T_1, k_1, V, k_1_, V_, T);
  latently_infected_CD4: nelson_1995b__latently_infected_CD4(time_, k_1, V, T, k_1_, V_, mu_T, k_2, T_1);
  actively_infected_CD4: nelson_1995b__actively_infected_CD4(time_, k_2, T_1, k_1D, D, mu_b, T_2);
  actively_coinfected_CD4: nelson_1995b__actively_coinfected_CD4(time_, k_1D, D, T_2, k_s, mu_bD, T_D2);
  stably_coinfected_CD4: nelson_1995b__stably_coinfected_CD4(time_, k_s, T_D2, T_D1);
  DIV: nelson_1995b__DIV(time_, mu_bD, T_D2, T_D1, D, N_t, mu_b);
  HIV1: nelson_1995b__HIV1(time_, N_t, mu_b, T_2, mu_bD, T_D2, k_1, T, mu_V, V);
  hybrid_HIV1: nelson_1995b__hybrid_HIV1(time_, mu_bD, T_D2, T_D1, mu_V, k_1_, T, V_, mu_b, N_t);
  production_function: nelson_1995b__production_function(time_, N_t);
  cell_population: nelson_1995b__cell_population(T, T_1, T_2, T_D2, T_D1);
end
