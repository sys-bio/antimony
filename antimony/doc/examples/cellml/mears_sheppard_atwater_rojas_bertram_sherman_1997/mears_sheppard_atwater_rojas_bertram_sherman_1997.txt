//Created by libAntimony v1.4
model mears_1997__environment(time_)
end

model mears_1997__membrane(V, time_, i_K, i_K_Ca, i_K_ATP, i_CRAC, i_Ca, i_leak)

  // Rate Rules:
  V' = -((i_Ca + i_K + i_K_ATP + i_K_Ca + i_CRAC + i_leak)) / Cm;

  // Variable initializations:
  V = -61;
  Cm = 6158;
end

model mears_1997__K_channel_n_gate(n, V, time_)

  // Assignment Rules:
  n_infinity := 1 / (1 + exp((Vn - V) / Sn));
  tau_n := 9.09 / (1 + exp((V - Vn) / Sn));

  // Rate Rules:
  n' = lambda_n * (n_infinity - n) / tau_n;

  // Variable initializations:
  n = 0.0005;
  Vn = -15;
  Sn = 6;
  lambda_n = 1.85;
end

model mears_1997__K_current(time_, i_K, V_K, V, n)

  // Sub-modules, and any changes to those submodules:
  K_channel_n_gate: mears_1997__K_channel_n_gate(n, V, time_);

  // Assignment Rules:
  i_K := g_K * n * (V - V_K);

  // Variable initializations:
  V_K = -70;
  g_K = 3900;
end

model mears_1997__K_ATP_current(i_K_ATP, V_K, time_, V)

  // Assignment Rules:
  i_K_ATP := g_K_ATP * (V - V_K);

  // Variable initializations:
  g_K_ATP = 150;
end

model mears_1997__fast_Ca_channel_m_gate(m_f_infinity, V, time_)

  // Assignment Rules:
  m_f_infinity := 1 / (1 + exp((Vm_f - V) / Sm_f));

  // Variable initializations:
  Vm_f = -20;
  Sm_f = 7.5;
end

model mears_1997__fast_Ca_current(i_Ca_f, V_Ca, time_, V, m_f_infinity)

  // Sub-modules, and any changes to those submodules:
  fast_Ca_channel_m_gate: mears_1997__fast_Ca_channel_m_gate(m_f_infinity, V, time_);

  // Assignment Rules:
  i_Ca_f := g_Ca_f * m_f_infinity * (V - V_Ca);

  // Variable initializations:
  V_Ca = 100;
  g_Ca_f = 810;
end

model mears_1997__slow_Ca_channel_m_gate(m_s_infinity, V, time_)

  // Assignment Rules:
  m_s_infinity := 1 / (1 + exp((Vm_s - V) / Sm_s));

  // Variable initializations:
  Vm_s = -16;
  Sm_s = 10;
end

model mears_1997__slow_Ca_channel_j_gate(jm, V, time_)

  // Assignment Rules:
  jm_infinity := 1 - 1 / (1 + exp((V - Vj) / Sj));
  tau_j := 50000 / (exp((V - Vj) / 4 ) + exp((Vj - V) / 4 )) + 1500;

  // Rate Rules:
  jm' = (jm_infinity - jm) / tau_j;

  // Variable initializations:
  jm = 0.12;
  Vj = -53;
  Sj = 2;
end

model mears_1997__slow_Ca_current(i_Ca_s, time_, V, V_Ca, m_s_infinity, jm)

  // Sub-modules, and any changes to those submodules:
  slow_Ca_channel_m_gate: mears_1997__slow_Ca_channel_m_gate(m_s_infinity, V, time_);
  slow_Ca_channel_j_gate: mears_1997__slow_Ca_channel_j_gate(jm, V, time_);

  // Assignment Rules:
  i_Ca_s := g_Ca_s * m_s_infinity * (1 - jm) * (V - V_Ca);

  // Variable initializations:
  g_Ca_s = 510;
end

model mears_1997__Ca_current_total(i_Ca, i_Ca_f, i_Ca_s)

  // Assignment Rules:
  i_Ca := i_Ca_f + i_Ca_s;
end

model mears_1997__K_Ca_current(i_K_Ca, time_, V, V_K, Ca_i)

  // Assignment Rules:
  i_K_Ca := g_K_Ca * power(Ca_i, 5 ) / (power(Ca_i, 5 ) + power(kdkca, 5 )) * (V - V_K);

  // Variable initializations:
  g_K_Ca = 1200;
  kdkca = 0.55;
end

model mears_1997__CRAC_r_gate(r_infinity, V, time_, Ca_er)

  // Assignment Rules:
  r_infinity := 1 / (1 + exp((Ca_er - Ca_er_bar) / sloper));

  // Variable initializations:
  Ca_er_bar = 40;
  sloper = 3;
end

model mears_1997__CRAC_current(i_CRAC, V_CRAC, time_, V, Ca_er, r_infinity)

  // Sub-modules, and any changes to those submodules:
  CRAC_r_gate: mears_1997__CRAC_r_gate(r_infinity, V, time_, Ca_er);

  // Assignment Rules:
  i_CRAC := g_CRAC * r_infinity * (V - V_CRAC);

  // Variable initializations:
  g_CRAC = 75;
  V_CRAC = 0;
end

model mears_1997__leak_current(i_leak, V_CRAC, time_, V)

  // Assignment Rules:
  i_leak := g_leak * (V - V_CRAC);

  // Variable initializations:
  g_leak = 0;
end

model mears_1997__ER_parameters(time_, Ca_i, J_er_p, O)

  // Assignment Rules:
  J_er_p := verp * power(Ca_i, 2 ) / (power(Ca_i, 2 ) + power(kerp, 2 ));
  a_infinity := 1 / (1 + dact / Ca_i);
  b_infinity := IP3 / (IP3 + dip3);
  h_infinity := 1 / (1 + Ca_i / dinh);
  O := power(a_infinity, 3 ) * power(b_infinity, 3 ) * power(h_infinity, 3 ) * 1;

  // Variable initializations:
  IP3 = 0;
  kerp = 0.09;
  verp = 0.24;
  dact = 0.35;
  dinh = 0.4;
  dip3 = 0.2;
end

model mears_1997__Ca_equations(time_, Ca_er, Ca_i, J_er_tot, J_er_p, J_mem_tot, O)

  // Sub-modules, and any changes to those submodules:
  ER_parameters: mears_1997__ER_parameters(time_, Ca_i, J_er_p, O);

  // Assignment Rules:
  J_er_tot := J_er_leak + J_er_IP3 - J_er_p;
  J_er_IP3 := O * (Ca_er - Ca_i);
  J_er_leak := perl * (Ca_er - Ca_i);

  // Rate Rules:
  Ca_er' = -(J_er_tot) / (lambda_er * sigma_er);
  Ca_i' = J_er_tot / lambda_er + J_mem_tot;

  // Variable initializations:
  Ca_er = 60;
  Ca_i = 0.11;
  perl = 0.003;
  lambda_er = 250;
  sigma_er = 1;
end

model mears_1997__Ca_membrane_flux(time_, i_Ca, Ca_i, J_mem_tot)

  // Assignment Rules:
  J_mem_tot := -(f) * (gamma * i_Ca + Jmp);
  Jmp := vmp * power(Ca_i, 2 ) / (power(Ca_i, 2 ) + power(kmp, 2 ));

  // Variable initializations:
  kmp = 0.35;
  vmp = 0.08;
  gamma = 0.000003607;
  f = 0.01;
end

model mears_1997____main()

  // Sub-modules, and any changes to those submodules:
  environment: mears_1997__environment(time_);
  membrane: mears_1997__membrane(V, time_, i_K, i_K_Ca, i_K_ATP, i_CRAC, i_Ca, i_leak);
  K_current: mears_1997__K_current(time_, i_K, V_K, V, n);
  K_ATP_current: mears_1997__K_ATP_current(i_K_ATP, V_K, time_, V);
  fast_Ca_current: mears_1997__fast_Ca_current(i_Ca_f, V_Ca, time_, V, m_f_infinity);
  slow_Ca_current: mears_1997__slow_Ca_current(i_Ca_s, time_, V, V_Ca, m_s_infinity, jm);
  Ca_current_total: mears_1997__Ca_current_total(i_Ca, i_Ca_f, i_Ca_s);
  K_Ca_current: mears_1997__K_Ca_current(i_K_Ca, time_, V, V_K, Ca_i);
  CRAC_current: mears_1997__CRAC_current(i_CRAC, V_CRAC, time_, V, Ca_er, r_infinity);
  leak_current: mears_1997__leak_current(i_leak, V_CRAC, time_, V);
  Ca_equations: mears_1997__Ca_equations(time_, Ca_er, Ca_i, J_er_tot, J_er_p, J_mem_tot, O);
  Ca_membrane_flux: mears_1997__Ca_membrane_flux(time_, i_Ca, Ca_i, J_mem_tot);
end
