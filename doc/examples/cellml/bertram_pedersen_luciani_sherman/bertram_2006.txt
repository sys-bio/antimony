//Created by libAntimony v1.3
model bertram_2006__Environment(time_)
end

model bertram_2006__Mitochondrial_variables(NADHm, Jpdh, Jo, NADm, ADPm, PSIm, Cam, ATPm, RATm, Jant, Jf1f0, Jh_res, Jh_atp, Jh_leak, Jnaca, Juni, time_, Jmito)

  // Assignment Rules:
  NADm := NADtot - NADHm;
  ATPm := Amtot - ADPm;
  RATm := ATPm / ADPm;

  // Rate Rules:
  NADHm' = gamma * (Jpdh - Jo);
  ADPm' = gamma * (Jant - Jf1f0);
  PSIm' = (Jh_res - Jh_atp - Jant - Jh_leak - Jnaca - Juni * 2 ) / Cmito;
  Cam' = -(fm) * Jmito;

  // Variable initializations:
  NADHm = 0.6;
  gamma = 0.001;
  ADPm = 7.4;
  PSIm = 93;
  Cam = 0.1;
  NADtot = 10;
  fm = 0.01;
  Cmito = 1.8;
  Amtot = 15;
end

model bertram_2006__Cytosol(time_, c, ATPc, Jant)

  // Assignment Rules:
  ATPc := Ac_tot - ADPc;
  Jh_yd := (khyd * c + Jhydbas) * ATPc / 1;
  delta := 3.9 / 53.2;

  // Rate Rules:
  ADPc' = -(delta) * Jant + Jh_yd * 1;

  // Variable initializations:
  ADPc = 1850;
  Ac_tot = 2500;
  khyd = 0.00005;
  Jhydbas = 0.00005;
end

model bertram_2006__Clamp_parameters(time_, Fproto, Cproto)

  // Assignment Rules:
  Fproto := Fhold + (Ftest - Fhold) * (heav_on - heav_off);
  Cproto := Chold + pulse1 + pulse2 + pulse3;
  pulse1 := (Ctest - Chold) * (heav_Cton1 - heav_Ctoff1);
  pulse2 := (Ctest - Chold) * (heav_Cton2 - heav_Ctoff2);
  pulse3 := (Ctest - Chold) * (heav_Cton3 - heav_Ctoff3);
  heav_on := piecewise( 1 , time_ - Fton >= 0 , 0 );
  heav_off := piecewise( 1 , time_ - Ftoff >= 0 , 0 );
  heav_Cton1 := piecewise( 1 , time_ - Cton1 >= 0 , 0 );
  heav_Cton2 := piecewise( 1 , time_ - Cton2 >= 0 , 0 );
  heav_Cton3 := piecewise( 1 , time_ - Cton3 >= 0 , 0 );
  heav_Ctoff1 := piecewise( 1 , time_ - Ctoff1 >= 0 , 0 );
  heav_Ctoff2 := piecewise( 1 , time_ - Ctoff2 >= 0 , 0 );
  heav_Ctoff3 := piecewise( 1 , time_ - Ctoff3 >= 0 , 0 );

  // Variable initializations:
  Fhold = 1;
  Ftest = 5;
  Fton = 90000;
  Ftoff = 330000;
  Chold = 0.1;
  Ctest = 0.1;
  Cton1 = 120000;
  Cton2 = 180000;
  Cton3 = 240000;
  Ctoff1 = 150000;
  Ctoff2 = 210000;
  Ctoff3 = 270000;
end

model bertram_2006__Clamp_protocol(time_, c, Fproto, Cproto, FBP)

  // Sub-modules, and any changes to those submodules:
  Clamp_parameters: bertram_2006__Clamp_parameters(time_, Fproto, Cproto);

  // Rate Rules:
  c' = (Cproto - c) / 0.1;
  FBP' = (Fproto - FBP) / 0.1;

  // Variable initializations:
  c = 0.1;
  FBP = 0.5;
end

model bertram_2006__Parameters(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15, p16, p17, p18, p19, p20, p21, p22, p23, p24)

  // Variable initializations:
  p1 = 400;
  p2 = 1;
  p3 = 0.01;
  p4 = 0.6;
  p5 = 0.1;
  p6 = 177;
  p7 = 5;
  p8 = 7;
  p9 = 0.1;
  p10 = 177;
  p11 = 5;
  p12 = 120;
  p13 = 10;
  p14 = 190;
  p15 = 8.5;
  p16 = 35;
  p17 = 0.002;
  p18 = -0.03;
  p19 = 0.35;
  p20 = 2;
  p21 = 0.01;
  p22 = 1.1;
  p23 = 0.001;
  p24 = 0.016;
end

model bertram_2006__J_variables(Juni, Jpdh, Jnaca, Jmito, Jh_leak, Jh_atp, Jo, Jh_res, Jf1f0, Jant, c, PSIm, Cam, NADHm, p1, p2, p3, p21, p22, p23, p24, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15, p16, p17, p18, p19, p20, NADm, ATPm, ATPc, RATm, FBP)

  // Sub-modules, and any changes to those submodules:
  Parameters: bertram_2006__Parameters(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15, p16, p17, p18, p19, p20, p21, p22, p23, p24);

  // Assignment Rules:
  Juni := (p21 * PSIm - p22) * power(c, 2 );
  Jpdh := p1 / (p2 + NADHm / NADm) * (Cam / (p3 + Cam)) * Jgpdh;
  Jnaca := p23 * Cam / c * exp(p24 * PSIm);
  Jmito := Jnaca - Juni;
  Jh_leak := p17 * PSIm + p18;
  Jh_atp := b13 / (1 + exp((p14 - PSIm) / p15));
  Jo := MM1 / (1 + exp((PSIm - p6) / p7));
  Jh_res := MM2 / (1 + exp((PSIm - p10) / p11));
  Jf1f0 := b2 / (1 + exp((p14 - PSIm) / p15));
  Jant := p19 * RATm / (RATm + p20) / exp(-(0.5 ) * FRT * PSIm);
  Jgpdh := kgpdh * root(FBP / 1 );
  MM1 := p4 * NADHm / (p5 + NADHm);
  MM2 := p8 * NADHm / (p9 + NADHm);
  b13 := p12 * p13 / (p13 + ATPm);
  b2 := p16 * p13 / (p13 + ATPm);

  // Variable initializations:
  FRT = 0.037;
  kgpdh = 0.0005;
end

model bertram_2006____main()

  // Sub-modules, and any changes to those submodules:
  Environment: bertram_2006__Environment(time_);
  Mitochondrial_variables: bertram_2006__Mitochondrial_variables(NADHm, Jpdh, Jo, NADm, ADPm, PSIm, Cam, ATPm, RATm, Jant, Jf1f0, Jh_res, Jh_atp, Jh_leak, Jnaca, Juni, time_, Jmito);
  Cytosol: bertram_2006__Cytosol(time_, c, ATPc, Jant);
  Clamp_protocol: bertram_2006__Clamp_protocol(time_, c, Fproto, Cproto, FBP);
  J_variables: bertram_2006__J_variables(Juni, Jpdh, Jnaca, Jmito, Jh_leak, Jh_atp, Jo, Jh_res, Jf1f0, Jant, c, PSIm, Cam, NADHm, p1, p2, p3, p21, p22, p23, p24, p4, p5, p6, p7, p8, p9, p10, p11, p12, p13, p14, p15, p16, p17, p18, p19, p20, NADm, ATPm, ATPc, RATm, FBP);
end
